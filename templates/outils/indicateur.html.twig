{% form_theme form 'bootstrap_4_layout.html.twig' %}
{% extends 'base.html.twig' %}

{% block title %}Indicateur{% endblock %}

{% block body %}
    <style>
        #flotPie1  {
            height: 150px;
        }
        #flotPie1 td {
            padding:3px;
        }
        #flotPie1 table {
            top: 20px!important;
            right: -10px!important;
        }

    </style>

    <div class="breadcrumbs "><!-- Breadcrumbs-->
        <div class="breadcrumbs-inner shadow-sm p-3 bg-white rounded">
            <div class="row m-0">
                <div class="col-sm-4">
                    <div class="page-header float-left">
                        <div class="page-title">
                            <h1>Indicateur</h1>
                        </div>
                    </div>
                </div>
                <div class="col-sm-8">
                    <div class="page-header float-right">
                        <div class="page-title">
                            <ol class="breadcrumb text-right">
                                <li><a href="#">Outils</a></li>
                                <li><a href="#">Suivi</a></li>
                                <li class="active">Indicateur</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div><!-- /.breadcrumbs-->

    <div class="content"><!-- Content -->

        <div class="animated fadeIn"> <!-- Animated -->

            <div class="card">
                {# cool nuance de noir #1C2833 #}
                <div class="card-header shadow p-3 rounded" style="background-color: #03A9F3; color: white; text-align: center">
                    Mes mesures
                </div>
                <div class="card-body">
                    {{ form_start(form) }}
                    <div class="container">
                        <div class="row row-cols-4">
                            <div class="col">{{ form_label(form.sexe) }}{{ form_widget(form.sexe) }}</div>
                            <div class="col">{{ form_label(form.age) }}{{ form_widget(form.age) }}</div>
                            <div class="col">{{ form_label(form.taille) }}{{ form_widget(form.taille) }}</div>
                            <div class="col">{{ form_label(form.poids) }}{{ form_widget(form.poids) }}</div>
                            <div class="col">{{ form_label(form.niveauActivite) }}{{ form_widget(form.niveauActivite) }}</div>
                            <button class="btn">{{ button_label|default('Enregistrer') }}</button>
                        </div>
                    </div>
                    {{ form_end(form) }}
                </div>
            </div>

            <div class="row"><!-- widget bilan -->

                <div class="col-sm-12 mb-4">
                    <div class="card-group">
                        <div class="card col-md-6 no-padding ">
                            <div class="card-body">
                                <div class="h1 text-muted text-right mb-4">
                                    <i class="fab fa-nutritionix"></i>
                                </div>

                                <div class="h4 mb-0">
                                    <span class="count">{{ metabolismeBase }}</span>
                                </div>

                                <small class="text-muted text-uppercase font-weight-bold">métabolisme de base</small>
                                <div class="progress progress-xs mt-3 mb-0 bg-flat-color-1" style="width: 40%; height: 5px;"></div>
                            </div>
                        </div>

                        <div class="card col-md-6 no-padding ">
                            <div class="card-body">
                                <div class="h1 text-muted text-right mb-4">
                                    <i class="fas fa-weight"></i>
                                </div>
                                <div class="h4 mb-0">
                                    <span class="count">{{ poidsIdeal }}</span>
                                </div>
                                <small class="text-muted text-uppercase font-weight-bold">Poids idéal</small>
                                <div class="progress progress-xs mt-3 mb-0 bg-flat-color-3" style="width: 40%; height: 5px;"></div>
                            </div>
                        </div>
                        <div class="card col-md-6 no-padding ">
                            <div class="card-body">
                                <div class="h1 text-muted text-right mb-4">
                                    <i class="fas fa-tint"></i>
                                </div>
                                <div class="h4 mb-0">
                                    <span class="count">{{ quantiteEau }}</span>ml
                                </div>
                                <small class="text-muted text-uppercase font-weight-bold">d'eau/j</small>
                                <div class="progress progress-xs mt-3 mb-0 bg-flat-color-4" style="width: 40%; height: 5px;"></div>
                            </div>
                        </div>
                        <div class="card col-md-6 no-padding ">
                            <div class="card-body">
                                <div class="h1 text-muted text-right mb-4">
                                    <i class="fas fa-male"></i>
                                </div>
                                <div class="h4 mb-0">
                                    {% if img == null %}
                                        <span>?</span>
                                        <span>%</span>
                                    {% else %}
                                        <span class="count">{{ img }}</span>
                                        <span>%</span>
                                    {% endif %}
                                </div>
                                <small class="text-muted text-uppercase font-weight-bold">IMG</small>
                                <div class="progress progress-xs mt-3 mb-0 bg-flat-color-5" style="width: 40%; height: 5px;"></div>
                            </div>
                        </div>
                        <div class="card col-md-6 no-padding ">
                            <div class="card-body">
                                <div class="h1 text-muted text-right mb-4">
                                    <i class="fas fa-child"></i>
                                </div>
                                <div class="h4 mb-0">
                                        {% if imc == null %}
                                            <span>?</span>
                                        {% else %}
                                            <span class="count">{{ imc }}</span>
                                        {% endif %}
                                    </span>
                                </div>
                                <small class="text-muted text-uppercase font-weight-bold">IMC</small>
                                <div class="progress progress-xs mt-3 mb-0 bg-flat-color-1" style="width: 40%; height: 5px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!-- .row widget bilan -->

            <div class="row"><!--  Widget calories  -->
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="box-title">Calories : Metabolisme de base = {{ metabolismeBase }} / Besoin calorique journalier = {{ besoinCalorique|round() }}</h4>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="card-body">
                                    <canvas id="cprPieChart" width="200" height="200"></canvas>
                                    {% set pdej = besoinCalorique * 0.25 %}
                                    {% set dej = besoinCalorique * 0.40 %}
                                    {% set gouter = besoinCalorique * 0.05 %}
                                    {% set diner = besoinCalorique * 0.30 %}
                                </div>
                            </div>

                            <div class="col-lg-6">
                                <div class="card-body">
                                    <canvas id="macroChart" width="200" height="200"></canvas>
                                    {% set glucide = besoinCalorique * 0.5 / 4 %}
                                    {% set proteine = besoinCalorique * 0.15 /4 %}
                                    {% set lipide = besoinCalorique * 0.35 / 9 %}
                                </div>
                            </div>
                        </div> <!-- /.row -->
                        <div class="card-body"></div>

                    </div>
                </div>
            </div><!-- Fin row calorie -->

            <div class="row"><!-- Widget IMC IMG -->

                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="mb-3">Indice de Masse Corporelle</h4>
                        </div>
                    </div>
                </div><!-- /# column -->

                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="mb-3">Indice de Masse Grasse</h4>
                        </div>
                    </div>
                </div><!-- /# column -->

            </div><!-- Fin partie IMC IMG -->

            <div class="row"><!--  Widget hydratation  -->
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="box-title">Hydratation</h4>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="card-body">


                                </div> <!-- /.card-body -->
                            </div>

                            <div class="col-lg-6">
                                <div class="card-body">

                                </div>
                            </div>
                        </div> <!-- /.row -->
                        <div class="card-body"></div>

                    </div>
                </div>
            </div><!-- Fin row hydratation -->

        </div><!-- .animated -->
    </div><!-- /.content -->

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    new Chart(document.getElementById("cprPieChart"), {
        type: 'doughnut',
        data: {
            labels: ["Petit déjeuner", "Déjeuner", "Gouter", "Dîner"],
            datasets: [{
                label: "Calories par repas",
                backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9"],
                data: [{{ pdej|round() }},{{ dej|round() }},{{ gouter|round() }},{{ diner|round() }}],
                borderWidth: 5,
                // cutout: 100,
                hoverOffset: 5,
            }]
        },
        options: {
            plugins: {
                legend:{
                  position: 'bottom',
                },
                title:{
                    display:true,
                    text: 'Calories journalier',
                    position: 'top',
                },
              tooltip: {
                  // enabled: false,
                  // intersect: false,
              },
            },
            responsive: true,
        }
    });


    new Chart(document.getElementById("macroChart"), {
        type: 'bar',
        data: {
            labels: ["Glucides","Protéines","Lipides"],
            datasets: [
            {
                // label: ["Glucides","Protéines","Lipides"],
                data: [{{ glucide|round() }}, {{ proteine|round() }}, {{ lipide|round() }}],
                backgroundColor: ["#3e95cd", "#8e5ea2", "#3cba9f"],
            },
            ]
        },
        options: {
            plugins: {
                legend:{
                    display: false,
                    // position: 'bottom',
                },
                title:{
                    display:true,
                    text: 'Macronutriment journalier',
                    position: 'top',
                },
                tooltip: {
                    // enabled: false,
                    // intersect: false,
                },
            },
            responsive: true,
        }
    });
</script>


{% endblock %}
